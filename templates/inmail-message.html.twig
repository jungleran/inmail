{#
/**
 * @file
 * Default theme implementation for Inmail Message element.
 *
 * Available variables:
 * - message: Parsed Inmail Message object.
 *    It could be either \Drupal\inmail\MIME\Message or
 *    \Drupal\inmail\MIME\MultipartMessage.
 * - view_mode: View mode; for example, "teaser" or "full".
 * - body: Plain text and HTML message body representation.
 * - attributes: HTML attributes for the containing element.
 *
 * The following variables are available for MIME messages only:
 * - (optional) attachments: A list of elements representing attachments.
 * - (optional) unknown: A list of unknown message part elements.
 *
 * @ingroup themeable
 */
#}

{{ attach_library('inmail/message') }}

{% if view_mode == 'full' %}
  {{ attach_library('inmail/inmail.message') }}
{% endif %}

<section class="inmail-message inmail-message--{{ view_mode }}">
  <header class="inmail-message__header">
    <div class="inmail-message__element inmail-message__header__from">
      <label>From</label>
      {{ addresses_from }}
    </div>
    {% for address_to in addresses_to %}
      <div class="inmail-message__element inmail-message__header__to">
        <label>To</label>
        {{ address_to }}
      </div>
    {% endfor %}
    {% for address_cc in addresses_cc %}
      <div class="inmail-message__element inmail-message__header__cc">
        <label>CC</label>
        {{ address_cc }}
      </div>
    {% endfor %}
    <div class="inmail-message__element inmail-message__header__received-date">
      <label>Received</label>
      {{ message.getReceivedDate() }}
    </div>
    <div class="inmail-message__element inmail-message__header__subject">
      <label>Subject</label>
      {{ message.subject }}
    </div>
    <div class="inmail-message__element inmail-message__header__all">
      <label>All Headers</label>
      <pre>{{ message.header.toString() }}</pre>
    </div>
  </header>
  <main class="inmail-message__body">
    {% if view_mode == 'teaser' %}
      <div class="inmail-message__element inmail-message__body__subject">{{ message.subject }}</div>
    {% endif %}
    {% if view_mode == 'full' and body.plain and body.html %}
      <ul>
        <li><a href="#inmail-message__body__content">Plain</a></li>
        <li><a href="#inmail-message__body__html">HTML</a></li>
      </ul>
    {% endif %}
    {% if body.plain %}
      <div class="inmail-message__element inmail-message__body__content" id="inmail-message__body__content">{{ body.plain }}</div>
    {% endif %}
    {% if body.html %}
      <div class="inmail-message__element inmail-message__body__html" id="inmail-message__body__html">{{ body.html }}</div>
    {% endif %}
  </main>
  {% if attachments and view_mode == 'full' %}
    <footer class="inmail-message__footer">
      <label>Attachments</label>
      <ul>
        {% for attachment in attachments %}
          <li>
            {% if attachment.url %}
              <a href="{{ attachment.url }}" title="{{ attachment.filename }}" target="_blank">{{ attachment.filename }}</a> ({{ attachment.filesize }})
            {% else %}
              {{ attachment.filename }} ({{ attachment.filesize }})
            {% endif %}
          </li>
        {% endfor %}
      </ul>
    </footer>
  {% endif %}
</section>
